<!DOCTYPE html>
<html>
<head>
<title>Solarcompare</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet"
	href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script
	src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script>
  $.ajaxSetup({ cache: false });
  $('#overview').live('pageinit', startup);
  function startup() {
  	loadValues()
  	window.setInterval(loadValues, 5000)
  }
   
  function loadValues() {
  	console.log('Rerequesting values...')
  	$.getJSON( "plants/jbr", function(data) {
  		console.log('Got reply, updating values on page...')
  		$('#jbrpac').html(data.PowerAc)
  		$('#jbretoday').html(data.EnergyToday)
  		var update = new Date(Date.parse(data.LatestUpdate))
  		if (!isNaN(update.getHours()))
  			$('#jbrupd').html(update.getHours() + ":" + update.getMinutes() + ":" + update.getSeconds())
  	} )
  	$.getJSON( "plants/peterlarsen", function(data) {
  		console.log('Got reply, updating values on page...')
  		$('#plpac').html(data.PowerAc)
  		$('#pletoday').html(data.EnergyToday)
  		var update = new Date(Date.parse(data.LatestUpdate))
  		if (!isNaN(update.getHours()))
	  		$('#plupd').html(update.getHours() + ":" + update.getMinutes() + ":" + update.getSeconds())
  	} )
  	$.getJSON( "plants/kaup", function(data) {
  		console.log('Got reply, updating values on page...')
  		$('#kauppac').html(data.PowerAc)
  		$('#kaupetoday').html(data.EnergyToday)
  		var update = new Date(Date.parse(data.LatestUpdate))
   		if (!isNaN(update.getHours()))
 	 		$('#kaupupd').html(update.getHours() + ":" + update.getMinutes() + ":" + update.getSeconds())
  	} )
  	$.getJSON( "plants/gldv33", function(data) {
  		console.log('Got reply, updating values on page...')
  		$('#gldv33pac').html(data.PowerAc)
  		$('#gldv33etoday').html(data.EnergyToday)
  		var update = new Date(Date.parse(data.LatestUpdate))
  		if (!isNaN(update.getHours()))
	  		$('#gldv33upd').html(update.getHours() + ":" + update.getMinutes() + ":" + update.getSeconds())
  	} )
  }
  </script>
<style type="text/css">
table.comp td {
	padding: 10px;
	border-bottom: 1px solid gray;
}
table.comp th {
	padding: 10px;
	border-bottom: 2px solid black;
	
}
body {
	font-size: 10pt;
}
p.update-text {
	font-size: 8pt;
}
</style>

</head>
<body>

	<div data-role="page" id="overview">

		<div data-role="header">
			<h2>Sol sammenlign</h2>
		</div>
		<!-- /header -->

		<div data-role="content">
			<table data-role="table" class="comp"
				id="my-table" data-mode="reflow" width="100%">
				<thead>
					<tr>
						<th style="text-align: left"></th>
						<th>Jesper<p class="update-text" id="jbrupd"></p></th>
						<th>Peter<p class="update-text" id="plupd"></p></th>
						<th>Glen<p class="update-text" id="kaupupd"></p></th>
						<th>Rune<p class="update-text" id="gldv33upd"></p></th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td><b>Aktuel produktion</b></td>
						<td style="text-align: right"><span id="jbrpac"></span> W</td>
						<td style="text-align: right"><span id="plpac"></span> W</td>
						<td style="text-align: right"><span id="kauppac"></span> W</td>
						<td style="text-align: right"><span id="gldv33pac"></span> W</td>
					</tr>
					<tr>
						<td><b>Produktion i dag</b></td>
						<td style="text-align: right"><span id="jbretoday"></span> Wh</td>
						<td style="text-align: right"><span id="pletoday"></span> Wh</td>
						<td style="text-align: right"><span id="kaupetoday"></span> Wh</td>
						<td style="text-align: right"><span id="gldv33etoday"></span> Wh</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- /content -->

	</div>
	<!-- /page -->

</body>
</html>
